# VCU整车控制器

## VCU概述

​	VCU (Vehicle Control Unit) 车辆控制单元/整车控制器，是电车控制中的中枢控制系统，可以说是电车的大脑。负责接收其他ECU(Electronic Control Unit)电子控制器的信号，判断当前车辆状态以及预测司机意图，将车辆在平稳，安全的前提下，以最高性能运行。

## VCU的功能

### 动力系统协同控制

1. 扭矩仲裁

   根据加速踏板/制动踏板的输入信号，再结合BMS(Battery Management System)反馈的动力电池SOC(State of Charge)值和电机温度等数据，计算出当前实时的扭矩需求，然后再将信号传递给MCU(Motor Control Unit)，由MCU执行控制。

2. 驾驶模式切换

   根据当前车辆运行的模式，如：经济/运动等模式，根据不同模式调整扭矩相应曲线和能量回收强度。

3. 挡位逻辑控制

   根据当前物理挡位请求与实际车速实现逻辑挡位输出。

### 能量流智能管理

1. 能量回收

   协调制动系统，将减速动能转化为电能存储起来，根据BMS反馈的SOC值再进一步判断是否对动力电池进行充电。

2. 功率分配

   与BMS充分协调，根据实时电量状态以及驾驶需求进行功率的合理分配，保证动力电池的续航电量能够高效合理利用，以达到最优的能量使用效果——更强的动力，或更长的续航里程。。

### 车辆状态管理与通信枢纽

1. 网关功能

   通过CAN总线连接BMS、MCU等模块，实现高速数据交互。

2. 状态显示与附件管理

   结合SOC以及历史能耗情况信息计算续航里程，驱动并显示仪表盘信息。控制空调、PTC、油泵、DCDC、水泵等附件工作。

### 安全监控与故障处理

1. 故障诊断

   实时监测高压系统绝缘电阻、接触器状态、通信异常等，触发分级警报。主流分级标准：基于危害程度的动力电池故障分级：

   * 三级故障——电池性能衰退
   * 二级故障——单体欠压、压差过大、温度异常
   * 一级故障——绝缘失效、短路、热失控

2. 跛行模式

   关键部件故障时，VCU降级控制，限制车辆功率，维持基础行驶功能。能够使车辆行驶致就近的维修站进行维修。

3. 高压安全防护

### 冷热管理系统协调

1. 电池热管理

   * 低温充电时：触发PTC或热泵加热电池；
   * 高温快充时：启动也冷系统，维持电池温度在安全区间。

2. 电机冷却控制

   根据电机我呢度调节水泵转速。

3. 座舱舒适性调节

   联动热泵/PTC/压缩机，以最低能耗维持设定温度。

### 例：大运汽车4.5t纯电动物流车VCU具体功能

1. 高压上下电控制
   * 驱动上电
   * 驱动下电
   * 故障下电
2. 挡位识别
3. 驱动功能
   * 驱动扭矩控制
   * 制动回馈扭矩控制
   * 跛行回家
   * 最高车速限制
4. 安全管理功能
5. 制动优先功能
6. 附件管理功能
7. 故障处理功能
8. 动力电车剩余功率计算功能
9. 倒车灯控制
10. 制动灯控制
11. 远程锁车

## VCU常见外观以及PCB示意图

![img](https://pic1.zhimg.com/80/v2-c5e43b0569738f5933db6b5505936c40_720w.webp?source=1def8aca)

![img](https://pic1.zhimg.com/80/v2-e493c6af07d7dd9e88409bd5a24283ed_720w.webp?source=1def8aca)

## VCU软件架构

​	由于VCU作为所有车载ECU(Electric Control Unit)的仲裁器，需要接受处理各种信号，对于实时性以及稳定性的要求，将采用嵌入式操作系统进行任务调度。那么此时VCU的软件架构就有如下表格所示：

| Scheduler | Layer      | Instance                                   |
| --------- | ---------- | ------------------------------------------ |
| 任        | 应用层     | 报文处理模块、驱动控制模块、诊断功能模块等 |
| 务        | 操作系统   | OSEK、QNX、AUTOSAR OS                      |
| 调        | 硬件驱动层 | CAN驱动、DI/DO/AI/AO驱动                   |
| 度        | 硬件层     |                                            |



## VCU应用的CAN网络拓扑

（该网络拓扑参考1.纯动车系统整体架构（系统培训ppt）2.大运汽车4.5t纯电物流车整车网络拓扑）

![image-20250815170736664](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250815170736664.png)

> CAN(Controller Area Network)控制区域网,CAN 已成为国际标准 ISO11898(高速应用)和 ISO11519（低速应用），上述为闭环CAN网络，为高速应用，在网络两端的节点需要接上120Ω的电阻。

## 相关疑问

### Q1:PDU(Power Distribution Unit)高压配电箱为什么没有出现在上述的CAN通信拓扑图中？其是否可以划分为BMS的子系统下？

A:两者虽然联系紧密但是属于不同的子系统。BMS属于 **电池管理系统**，核心职责是电池安全，PDU属于 **高压配电系统**，核心职责是能量分配。两者通过 **高压接口直连** + **CAN总线通信** 协同工作，BMS是决策者——监控PDU状态以及故障上报，PDU是执行者——执行BMS下达指令操作。(内容来自deepseek)

### Q2:多合一控制器是可以把除了VCU之外的上述右侧部分ECU整合在一起，还是包括VCU？

A:参考公司产品介绍中的多合一控制器，可以发现多合一功能产品有主驱多合一和辅驱多合一产品，其集成功能包括：**MCU**、**DC/AC**、**DC/DC**、**PDU**、**OBC**、**EPS**、**KYJ**中的多个功能，都没有涉及到VCU，其原因可能包括：VCU本身对于实时性和稳定性的安全比较高，其控制接收的的信号本身就已经足够繁杂，不再适合集成其他功能。其中多合一控制器的优势：

* 减小体积，节省车辆空间；
* 集成模块，走线简洁，维护方便；
* 符合客户定制需求。

### Q3:主驱电机控制和辅驱电机控制是否指主驱电机的控制器和辅驱电机的控制器，在主驱动力不能满足的情况下才会调用辅驱？

A：在事业部产品介绍文档中，有两款主驱控制器，根据冷却方案不同分类：水冷主驱控制器和风冷主驱控制器，其主要驱动动力电机——永磁同步电机；辅驱控制器，用于控制气泵电机、转向电机。

### Q4:为何VCU通常需要两路CAN通信？

A：（以下内容来自Deepseek）

​	VCU选择两路或者多路CAN网络通信的原因有如下几点：

 1. 功能隔离，网阔分区

    ​	对于同一CAN网络而言，如果设备（节点）过多会导致通信过载，造成延迟以及丢帧等现象。分两路CAN网络，可以减少总线负担，对CAN网络进行功能分区，有助于后期的维护和问题诊断。一路CAN总线专门用于连接高实时性、高安全性要求的核心动力系统控制器，称为"动力CAN"；另一路CAN总线用于连接实时性要求相对较低、功能相对独立的车身电子，成为"车身CAN"。

    > 双CAN架构是现代电车或混动汽车VCU的标准配置

 2. 诊断与标定接口

    ​	一路CAN总线会连接到车辆的标准诊断接口，通常为"车身CAN"，维修以及开发人员可以通过该CAN网络查看诊断信息。

 3. 扩展、兼容性和可靠性

    ​	当车辆需要新增ECU时，可以根据功能归属接入合适的CAN网络。使用两路以上多路CAN总线，当其中一条总线损坏，另一条总线可以备用，这样的冗余设计可以提高可靠性。

    ​	

    
