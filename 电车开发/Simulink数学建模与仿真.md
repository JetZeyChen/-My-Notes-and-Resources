# Simulink 数学建模与仿真

## Simulink 概述

​	Simulink 是 MATLAB 环境下的**多域动态系统建模与仿真平台**，广泛应用于汽车控制、电力电子、航空航天等领域的算法开发与**硬件在环（HIL）**测试。

>HIL（Hardware in the Loop）硬件在环，是一种将**真实控制器**与**虚拟被控对象模型**实时连接的测试方法，广泛应用于汽车、航空航天等领域。其核心价值在于**在实验室环境下安全、高效地验证控制系统的可靠性与鲁棒性**。



## Simulink 在电车开发中的核心应用

1. 电机控制

   ​	用于验证FOC/SVPWM算法性能仿真

2. 电池管理

   ​	SOC估算精度、热失控预警

3. 整车能量管理

   ​	续航优化与再生制动策略

4. 高压配电

   ​	用于短路保护逻辑、预充电时序仿真
   
   

## Simulink 仿真步骤

​	仿真步骤流程图如下所示：

![image-20250816133305616](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250816133305616.png)

### 数学建模

​	这是Simulink最关键的一步，如何对所仿真的物理对象进行抽象数学模型建模，将其关键因素提取，构建数学模型，包含公式、方程组等数学表达式。使用数学语言描述物理对象。

### 控制器设计

​	许多仿真对象都具有一定的控制结果，如PID控制器，其在温控系统中就十分常用。Simulink库中可能没有现成可用的控制器，就需要手动搭建。

### 模型搭建

​	在Simulink中搭建仿真模型，需要根据数学建模进行。

### 参数调试

​	在开始仿真之前一些系统模型需要设定一些初始状态，初始值，以及一些参数的初始标定。在仿真的过程中也可以进行实时参数调整。

### 动态仿真

​	在构建好仿真模型之后，运行动态仿真可以实时观察仿真结果以及调整修改参数，查看系统仿真结果的变化。

### 结果分析

​	通过仿真结果分析参数，得出最有参数解，然后进行硬件上机验证。



## Simulink 应用实例

1. 使用Simulink仿真求解二阶振荡电路的输出波形：[Matlab simulink建模与仿真 第一章（simulink入门）-CSDN博客](https://blog.csdn.net/Zevalin/article/details/141297603)。

2. 两轮扫地机器人运动轨迹建模分析

   * **建模目的**

     ​	通过控制两个轮子的电机的扭矩，达到控制车辆运动轨迹的目的；

   * **数学建模及分析**

     ​	两轮扫地机器人，在计算过程中需要明确的静态参数有：小车质量 m = 2.5kg，轮子半径 r = 0.015m，两轮轴心距的一半 R = 0.2m，滚动阻力系数 Crr = 0.012，滚动阻力随速度的变化常熟 K1 = 3e-6，重力加速度 g = 9.81。

     ​	在本次建模中，理想化小车为一个圆形，两轮轴心建立X-Y直角坐标系，两轮分别位于Y轴的正负半轴上，如下图所示：

     ​	

     ​	电机驱动相关数学建模以单个车轮为例，另一个是一致的：

     ​							Fd - Fr = m / 2 * a

     ​							Fr = Crr * Fz

     ​							Fz = m* g / 2

     ​							Crr(v) = Crr0 + K1 * v * v 

     ​	其中：

     ​			Fd —— 由电机扭矩提供的驱动力；

     ​			Fr  —— 由于车辆轮胎形变产生的阻碍运动的滚动摩擦力；

     ​			Fz —— 车轮的垂直载荷，整车的重量有车轮共同承载；

     ​			Crr —— 滚动摩擦力系数，其影响因素包括车速。

     ​	**运动情况分析**：

       1. 当两轮车速一致，且运动方向一致时，小车向前直线运动；

          ​		Vl  - Vr = 0;

          ​		(Vl + Vr)   /2 = Vf;

          ​		VI = Vr = Vf;

          此时小车以V速度向前行驶。

       2. 当两轮车速不一致时，就会产生速度差，导致小车进行曲线运动；

          ​		(Vl - Vr) / 2 = Vr; Vr 为等效小车以一定点为圆心，以两轮轴距一半为半径画圆的线速度；

          ​		ω = Vr / R ；

          就可以获取小车曲线运动的角速度。

          **坐标转换**：

     然后以X轴正方向为起始，运动方向与X轴正半轴夹角为θ；

     ​			Vx = Vf * Cosθ ；

     ​			Vy = Vf * Sinθ ；

     分别对Vx，Vy对时间积分即是X坐标位置以及Y坐标位置。

   * **模块构建**

     ​	从 Simulink 构建顶层模块框架，拆分为五大子系统模块，力矩输入子系统，左轮/右轮驱动子系统，角速度子系统，坐标变换子系统。如下图所示：

     ​	在 Library Viewer 下的 Simulink 分支找到 Port & Subsystems，然后选择 Atomic Subsystem。原子子系统，子系统模块还分为虚拟子系统以及非虚拟子系统，详细内容可以查看MATLAB官网手册。

     ​						<img src="C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820185925481.png" alt="image-20250820185925481" style="zoom: 80%;" />

     ​	然后放置五个该模块，然后分别对其进行名称修改。双击每个模块可以定义内部模型。如下图所示：

     ![image-20250820190412012](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820190412012.png)

     ​	每个模块根据数学建模，进行模型的搭建：

     * 输入模块

       ![image-20250820190526895](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820190526895.png)

     * 左轮模块

       ![image-20250820190623051](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820190623051.png)

     * 角速度模块

       ![image-20250820190713960](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820190713960.png)

     * 坐标转换模块

       ![image-20250820190735487](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820190735487.png)

   * **仿真分析**

​		通过输入两个阶跃信号给到左右电机输入模块，作为电机的扭矩输出，解约时间为1s，给一定时间的延时，可以有利于观察前后的变化，然后阶跃值给1。运行仿真按钮，在输出端添加查看器Scope，仿真完成后可以看到相关的仿真信息。

​	此图为对左轮电机模块仿真的图像，提供一段时间的电机扭矩输出，速度会升后降至零，但是到零后反而反向增加，这就出现了一个问题，Fr 滚动摩擦力在速度为0时不为0！

![image-20250820191205301](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250820191205301.png)

> 此模块功能还需要调整，尽快完善电机模块的模型构建，电机自身反电动势也是电机后续停转的主要因素之一。

​	建模过程中遇到的问题：

​	P1: 对于具有反馈的加法器模块，如果输出作为反馈部分，则一般需要在反馈输入加入一个单元延迟单元，其在离散模块库部分，Unit Delay 顾名思义，其会延迟一个计算步长后再获取值，再次之前初始值都由人为设定。

​	P2：

## 相关疑问

### Q1: 如何获取最接近真实情况的建模参数，以达到仿真效果足够真实可靠？

A：(以下内容来自Deepseek)

​	一、基础参数测量（静态参数）

​		1.物理测量法，直接通过物理工具测量参数；

​		2.数据手册与标准库获取。

​	二、动态参数辨识

​		采用实验设计方法：

![image-20250816141302307](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250816141302307.png)

​	选择特定的激励信号输入到待测系统，采集系统响应，然后通过数学分析方法对系统传递函数进行拟合，如：对于线性系统采用最小二乘法，对于非线性系统采用遗传算法。然后在通过构建仿真模型，验证一致的激励输入情况下，响应是否一致。

> 对于参数的可信度验证，存在以下方法：
>
> 1. 交叉验证法
>
>    ​	使用同一个数据集，采集的数据70%用于系统模型构建，剩余30%的数据用于结果验证。查看结果的相似度，如果误差在可接收范围内，即认为数据可信。
>
> 2. 敏感度分析
>
>    ​	如果对参数进行±5%的幅度变化，对应系统的输出变化大于±10%，则认为该参数为关键参数。



### Q2:对物理对象进行数学建模，模型过于负责容易导致后续操作复杂，模型简单则容易忽略一些影响因素，应该如何正确的进行数学建模？

A:（以下内容来自Deepseek）

​	一、明确建模目的

​		用于控制器算法开发/系统性能预测/安全边界分析，还需考虑参数精度要求等。

​	二、四步建模法

​		![image-20250816143645270](C:\Users\10637\AppData\Roaming\Typora\typora-user-images\image-20250816143645270.png)

​		1.机理分析/第一性原理

​			物理定理锚定，确认数学表达式

​		2.结构简化

​			降阶简化，例如：非线性系统可以通过分段线性进行拟合。

​		3.参数辨识

​			这里便是上述Q1问题中的参数获取方法。

​		4.验证迭代

​			闭环矫正，不断进行上述2/3步骤以达到模型与实际系统高度吻合。
